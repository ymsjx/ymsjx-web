<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>饭卡余额篡改系统</title>




<style>
body{
    margin:0;
    padding:0;
    background:#ffffff;
    font-family:Arial, sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
}

.container{
    width:90%;
    max-width:400px;
    padding:20px;
}

h2{
    text-align:center;
}

input{
    width:100%;
    padding:10px;
    margin-top:10px;
    box-sizing:border-box;
    font-size:14px;
    border:1px solid #000;
}

button{
    width:100%;
    padding:10px;
    margin-top:15px;
    font-size:14px;
    border:1px solid #000;
    background:#ffffff;
    cursor:pointer;
}

button:hover{
    background:#f0f0f0;
}

.link-btn{
    background:none;
    border:none;
    color:blue;
    margin-top:8px;
    cursor:pointer;
}

.progress{
    width:100%;
    background:#e0e0e0;
    height:15px;
    margin-top:15px;
    display:none;
}

.progress-bar{
    height:100%;
    width:0%;
    background:#000000;
    transition:width 0.2s;
}

.log{
    margin-top:15px;
    font-size:13px;
    height:150px;
    overflow-y:auto;
    border:1px solid #000;
    padding:5px;
}

.hidden{
    display:none;
}
</style>
</head>
<body>

<div class="container">

<!-- 登录 -->
<div id="loginPage">
    <h2>欢迎使用校园饭卡余额篡改系统</h2>
    <h3>登录</h3>
    <input type="text" id="loginUser" placeholder="用户名">
    <input type="password" id="loginPass" placeholder="密码">
    <button onclick="login()">登录</button>
    <button class="link-btn" onclick="showRegister()">没有账号？注册</button>
    <h5>首次使用请注册账号</h5>
    <h6>仅供娱乐，切勿当真</h6>
</div>

<!-- 注册 -->
<div id="registerPage" class="hidden">
    <h2>欢迎使用校园饭卡余额篡改系统</h2>
    <h3>注册</h3>
    <input type="text" id="regUser" placeholder="用户名">
    <input type="password" id="regPass" placeholder="密码">
    <button onclick="register()">注册</button>
    <button class="link-btn" onclick="showLogin()">已有账号？登录</button>
    <h5>首次使用请注册账号</h5>
    <h6>仅供娱乐，切勿当真</h6>
</div>

<!-- 主页面 -->
<div id="mainPage" class="hidden">
    <h2>饭卡余额篡改系统</h2>

    <input type="text" id="cardNumber" placeholder="请输入卡号">
    <button onclick="startProcess()">开始处理</button>

    <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div id="balanceSection" class="hidden">
        <input type="text" id="balanceInput" placeholder="输入新余额">
        <button onclick="updateBalance()">确认修改</button>
    </div>

    <!-- 日志放在余额下面 -->
    <div class="log" id="log"></div>
    

</div>

</div>

<script>

// ===== 用户存储 =====
function getUsers(){
    return JSON.parse(localStorage.getItem("users") || "{}");
}
function saveUsers(users){
    localStorage.setItem("users", JSON.stringify(users));
}

// ===== 日志系统（带延迟）=====
function addLog(text){
    const logBox = document.getElementById("log");
    const time = new Date().toLocaleTimeString();
    logBox.innerHTML += "[" + time + "] " + text + "<br>";
    logBox.scrollTop = logBox.scrollHeight;
}

function clearLog(){
    document.getElementById("log").innerHTML = "";
}

function sleep(ms){
    return new Promise(resolve => setTimeout(resolve, ms));
}

// ===== 登录 =====
function login(){
    const user = loginUser.value.trim();
    const pass = loginPass.value.trim();
    const users = getUsers();

    if(users[user] && users[user] === pass){
        loginPage.classList.add("hidden");
        mainPage.classList.remove("hidden");
        clearLog();
        addLog("系统登录成功");
    }else{
        alert("账号或密码错误");
    }
}

// ===== 注册 =====
function register(){
    const user = regUser.value.trim();
    const pass = regPass.value.trim();

    if(!user || !pass){
        alert("请输入完整信息");
        return;
    }

    let users = getUsers();
    if(users[user]){
        alert("用户名已存在");
        return;
    }

    users[user] = pass;
    saveUsers(users);
    alert("注册成功");
    showLogin();
}

function showRegister(){
    loginPage.classList.add("hidden");
    registerPage.classList.remove("hidden");
}

function showLogin(){
    registerPage.classList.add("hidden");
    loginPage.classList.remove("hidden");
}

// ===== 第一阶段 =====
async function startProcess(){
    const card = cardNumber.value.trim();

    if(!card){
        alert("卡号不能为空");
        return;
    }

    balanceSection.classList.add("hidden");
    clearLog();

    runProgress();

    addLog("正在连接建设银行服务器...");
    await sleep(1000);

    addLog("读取卡号数据..");
    await sleep(1000);

    addLog("卡号验证通过...");
    await sleep(1000);

    addLog("已成功取得管理员权限");
    await sleep (1600)
    balanceSection.classList.remove("hidden");
}

// ===== 第二阶段 =====
async function updateBalance(){
    const balance = balanceInput.value.trim();

    if(!/^\d+$/.test(balance)){
        alert("余额只能输入数字");
        return;
    }

    runProgress();

    addLog("启动强力篡改程序...");
    await sleep(1000);

    addLog("正在尝试绕过建设银行防火墙...");
    await sleep(1000);

    addLog("强力篡改中....");
    await sleep(1000);

    addLog("篡改成功，正在同步学校账务系统...");
    await sleep(1000);

    addLog("正在清除篡改痕迹，请勿退出！");
    await sleep(1000);

    addLog("余额修改成功！新余额：" + balance);
}

// ===== 单进度条 =====
function runProgress(){
    const progress = document.querySelector(".progress");
    const bar = document.getElementById("progressBar");

    progress.style.display = "block";
    bar.style.width = "0%";

    let width = 0;
    let interval = setInterval(()=>{
        width += 3;
        bar.style.width = width + "%";
        if(width >= 100){
            clearInterval(interval);
            progress.style.display = "none";
        }
    }, 120);
}

// ===== 余额限制数字 =====
balanceInput.addEventListener("input", function(){
    this.value = this.value.replace(/\D/g,"");
});

</script>

</body>
</html>
